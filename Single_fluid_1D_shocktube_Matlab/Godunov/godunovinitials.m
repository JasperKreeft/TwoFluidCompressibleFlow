%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Initial conditions

rho1 = 1.0 ;
u1   = 0.0 ;
p1   = 1.0;

rho4 = 0.125 ;
u4   = 0.0 ;
p4   = 0.1 ;

gamma = 1.4;

X = 1;
N = 40;  %N even
dx = X/N;
x = 0:dx:1;
dt = 0.001;
soft = 1;   %BC 1  = soft; 0 = hard
limiter = 4;

for k=1:(N/2+1)  %soft boundaries
q(:,k)  = [rho1, rho1*u1, p1/(gamma-1) + 1/2*rho1*u1^2];
q(:,N/2+1+k)  = [rho4, rho4*u4, p4/(gamma-1) + 1/2*rho4*u4^2];
end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


small = 10^-15;